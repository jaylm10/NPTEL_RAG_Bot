hai in this lecture of the second part of implementation of iot with raspberry pi weare going to discuss the same integration we discussed previously that is integrationof a dht sensor with raspberry pi additionally we are going to include some networking componentsto it that is we are going to implement a python scripting for client making the raspberrypi behave as a client whereas on the remote desktop which will act as a server will useanother python script which will act as a udp server so in this way we are going tocreate a ah data gram based connection between the raspberry pi client and the desktop basedserver so again ah basic aim of this internet ofthings is to create an interactive environment of network devices which are all connectedtogether additionally your devices more the number of devices the more intelligent andinteractive your whole system should be it should not be that you are increasing yourdevice number of devices whereas your system performance is going down so by maintainingyour system performance the device integration has to be made so i am sure the various strategieshave been covered in the previous theoretical lectures in this one ah we are going to givea basic demonstration of whatever you have learnt in your previous lectures a rudimentaldemonstration so in this second lecture we will be focusmore on remote data logging so it will be collecting ah data from the devices in thenetwork it will send the data to a server or a remote machine and that remote machinewill the remote machine will control the client or the data sending device remotely so thesystem overview is as i have told you previously and network of temperature and humidity sensorswill be connected to raspberry pi here for the sake of demonstration we are only connectingone temperature and humidity sensor with single raspberry pi data from the sensors are redit is sent to the server over the network and the data is saved in the serverso same as before we have the same requirements a raspberry pi a dht sensor a four point kiloohm resistor ah it is to be noted that ah for raspberry pi this four point seven kiloohm resistor must be obtain between the bcc and the data pin that is between pin one andtwo ah additionally we will be requiring jumper wires to make our connections again for recapitulationwell go about discussing the dht so from left to right if you keep the gridside up you have pins numbered one to four first being the vcc pin fourth being the groundand the second pin is used for transmitting dataso the connection to the raspberry pi will b as follows ah from the previous lecturewe have just debuted a little bit you can also use the same ah configuration as donein the previous lectures but remember the board configuration for this dht sensor mustbe in bcm mode not in board mode so we are connecting the dht sensor to three point threevolt pin of raspberry pi we are connecting the data pin or pin two of the dht sensorto pin eleven of raspberry pi this pin eleven is in bcm mode and we are connecting pin fourof dht sensor to the ground pin of raspberry pi pinnow as in the previous lectures we have already covered this adafruit which supplies thisdht twenty two sensor they also provide a library to integrate sensor to raspberry pivia python frame work so this has already been installed during our previous lecturenow we are going to call the adafruit under score dht dot read retry function to readdata from the sensor so as you can see the codes and the outputs or more or less similarto the previous one we are going to the temperature only the additionally ah you can attach yourhumidity readings also but for the sake of testing you can just go with the temperaturereadings now for sending the data over the network we will be using a client server clientserver model and to establish the connection you are going to ah take the help of a udpbased socket ah will make a udp based socket which will send data from client to the servernow for this socket programming this generally sockets create a two way communicationbetween two nodes in a network one node is termed as the server whereas the other asis termed as the client the server performs the task or the service as requested by theclient so how do you proceed by creating a socket on raspberry pi this was also coveredin the previous lectures on introduction to raspberry pi so it is quite simple to assignthe socket dot socket function to a variable and you manipulate that variableso this socket dot socket function it has three arguments first is socket family secondis socket type and third is protocol which is by default zero socket family can be eitheraf under square unix or af under square inet so unix as you recall it is mainly for onthe unix base systems whereas for most of the general purpose programming we are goingwith af under score inet or internet protocols socket type can be either socket stream orsocket data gram now while sending a data from a client to a server we need two scriptsone for the server and one for the client and two things will be required first is theip address of the server and the port of the server to which your client will bindso your client can have a variety of ip addresses but it is important that your server retaina singular ip address see for this infrastructure for this exact project we are demonstratingyou only require one way communication that is from the client to the server so your clientsdo not need to have fixed ip addresses may be they can have a variety of ip addressesabout which the server has no prior knowledge but it is very important that each and everyclient should be aware of the servers ip address as well as the port to which the client isgoing to connect so we start off with calling the functions of socket dot socket we ah putthe host as socket dot get host name we assign a particular port and we bind to the portby calling the host name is the first argument and the port number as the second argumentand we start our listening function which waits for a client to connect to itnow while true it signifies while a client has accepted the connection and connectedto your server on that particular port it will ah generate one address and this addresscan be stored and later on ah used for ah later on used for time stamping your datato which ah on your server in various data logs so imagine your your server has beenconnected to twenty different ip addresses or clients so these twenty clients are sendingvariety of data to you but you need to know the exact location of each of these clientsso that later on you can segregate the data and connect to itso once your connection has been accepted it sends the server sends connection successfuland eventually when the socket is terminated by the user you call the functions c dot closefor the client side again you call the functions socket dot socket then you get the host nameassign the port point to remember is this port number is similar to the servers portnumber because your client will be connecting to servers that particular port number andthis host or the host name we are talking about this has to be the servers ip addressso s dot connect you connect to that particular ip address of that server on that particularport and you print that your data is being received s dot receive and eventually youclose the connection so prior to this let to show the basic circuit connection its againback to the basics we have this dht sensor the vcc the ground and the data pin are connectedto their corresponding pins as defined in the previous slides ah this raspberry pi isconnected to the network and we have already put in the client program on the raspberrypi we have already downloaded and install the adafriut python library on this so weare ready to go now again back to the presentation so we are actually aiming to capture datafrom this sensor create a socket transmit a data to our remotely located serverin this case my desktop will be the server and raspberry pi will be the client both ofthese are physically separate but connected via a singular network to which various otherdevices are also connected but since we are dealing with ip addresses and particular portsso we can expect zero intemperance from other devices so the client code for obtaining readingsfrom the sensor can be given as we define a function called sensor data you can giveit any other name so we set the board ah set the gpio to board mode we set the warningto false sensor is adafruit unless called dht dot am two three zero two then we ah graphthe humidity and temperature functions from the sensor and we return it to the callingfunction so in this client code for creating the socketas you can see the af under square inet has been called and a socket data gram is beingused for this particular program my pc has this following ip and i opened up port numberten thousand one if you can randomly choose ports to create a socket so i open port tenthousand one to accept connections from various clients so my system client will tryon sending data over the network to the server so h comma t that means ah these will be assignedthe humidity and temperature data from the sensor data function which we defined in theprevious slide and we formatted in the terms of a string and we transmitted over the socketto that particular server address and when this transmission is complete from ah fromah input receipt from the user and the user terminates the code the sock the close functionwill execute similarly the modification for a server sideis you again create an af under score inet and sock underscore data gram socket the addresswill be the servers address and the port will be the port which will be use for connectingvarious clients it and sock dot bind it starts the server port now while it is true it willkeep on infinitely looping the data and address will be received from the socket and chunksof four zero nine six bytes you open a any text file called data log text or any othername you want to chose it may even not be a text file it may be a csv file alsoso you use that file ah if you remember we covered file reading and writing in programmingintroduction to programming in python so using that similar concept you open a text fileand whatever data you are receiving over the network you start writing to the text fileas well as if you want you can keep one printing the data also so if you see we will get anoutput something like this your temperature readings ah first is humidity and the nextone is temperature so separated separated by a comma yours client will keep on streamingthis data over and over again new values not the old redundant values every time everydata pole it will generate a new value so lets into the sever code firstso over here i have my udp server so i have put in my ip and put in my port right datalog txt for there was this file data log dot txt i will deleted right this i have openedinappend mode so that your data keeps on appending on to the same file again and again withoutoverwriting the previous data so i start my server now as you can see the server has startedit will wait for connections from the client and until then it will do nothing now to accessthe client or the raspberry pi we remotely to this raspberry pi way system so we runthis particular program client dot py try to doing this you may just check whether oursensor is working fine or not let us try to read some temperature just like the previouslecture i will try running this dht temp fileok i need to change the portok this system is not responding i will login to this raspberry pi again yes so this ismy correct raspberry pi actually we have lots of raspberry pi s connected to over the networksowe check what exactly is the file content so this was covered in the presentation weopened our script file in a editor so you are first going to check whether our temperaturesensor working fine or not we will try running this code dht temp dot py i have shown inthe previous lecture so once this is executed if the sensor has been correctly connectedif the pins are correct it is suppose to return ah ah temperature value on the terminal soyes it appears that sensor is properly connected returns a value of twenty five point eightnine degree celsius now we can proceed with the more complicated part we will have a lookat the client programthis is a same program which was covered in the presentation we define a function calledsensor data we open up a socket aimed at this ip address which is my server or desktop forthis particular port ten thousand one you can change the port according to your needsand you iteratively keep on pushing data to this server so before beginning we will checkyes the server is still on it is still waiting for incoming messages from any client whichwill connect to it now a last made client to send data to this server so we see it issending two values this seventy four point three and twenty five point seven so firstone is for the humidity value and the second one is from the temperature readingsso this will iteratively keep on going again and again until the user terminates this programover at the server side you see the same thing is being received that humidity readings andthe corresponding temperature readings so for a demonstration i light up a match infront of the dht sensor and you can check the corresponding readings change over atthe server so see the temperature is slowly increasingso it has reach all most twenty seven you can see the same variations over at the clientside now i will terminate my client code so once this socket is close once i terminatethis will send a message closing socket and closes down the socket you see the servercode has stopped coming in right so whenever i start this code again my server will againstart receiving this code so this we demonstrated using one single raspberry pi as a clientand one single sensor you can obviously include multiple raspberry pis and multiple sensorsall sending data to this particular server or a single ip at the port and another thingwe will check when this data is incoming into the server initially i deleted this data logdot txt file now you see it has automatically created anotherdata log dot txt and this function once a open it you see all the data has been storedso this can be used as the server log or it can be extorted and use with various algorithmsfor higher processing so i hope giving some experience of integrating various sensorsover the network and creating a client server connection and i hope this will give you alittle bit touch of this iotthe course for which you have been ah uh attending these lectures and in the next lecture wewill be focusing more on what to do with the data and what exactly ah can be integratedcan be done you can may be plot the data you can store the data you can refine the datayou are storing and other such tasks thank you